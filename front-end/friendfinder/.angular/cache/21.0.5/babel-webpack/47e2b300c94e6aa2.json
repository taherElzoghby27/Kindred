{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, ViewChild } from '@angular/core';\nimport { PostRequest } from '../../../../model/post-request';\nimport { SnackbarPanelClass } from '../../../../enum/snackbar-panel-class.enum';\nlet PublishComponent = class PublishComponent {\n  constructor(postService, snackBar) {\n    this.postService = postService;\n    this.snackBar = snackBar;\n    this.selectedFileName = null;\n    this.previewUrl = null;\n    this.isImage = false;\n    this.loading = false;\n    this.errorMessage = '';\n  }\n  // create post (publish)\n  publish() {\n    if (!this.validateFields()) {\n      return;\n    }\n    const post = new PostRequest(null, this.content, this.file == null ? '' : this.file.name);\n    this.postService.createPost(post).subscribe(success => {\n      this.showSnackBar('Published', SnackbarPanelClass.Success);\n      this.clearData();\n    }, errors => {\n      this.showSnackBar(errors.error.bundleMessage.message_en, SnackbarPanelClass.Error);\n    });\n  }\n  validateFields() {\n    if (!this.selectedFileName && !this.content) {\n      this.errorMessage = 'One Required';\n      return false;\n    }\n    return true;\n  }\n  clearData() {\n    this.errorMessage = '';\n    this.selectedFileName = null;\n    this.content = null;\n    this.previewUrl = null;\n    this.file = null;\n  }\n  onMediaClick() {\n    this.mediaInput.nativeElement.click();\n  }\n  onMediaSelected(event) {\n    const input = event.target;\n    if (input.files && input.files.length > 0) {\n      this.file = input.files[0];\n      this.selectedFileName = this.file.name;\n      this.loading = true;\n      this.previewImage(this.file);\n    }\n  }\n  previewImage(file) {\n    // Preview (local only)\n    const reader = new FileReader();\n    reader.onload = () => {\n      this.previewUrl = reader.result;\n      this.isImage = file.type.startsWith('image/');\n      this.loading = false;\n    };\n    reader.readAsDataURL(file);\n  }\n  showSnackBar(message, snackType) {\n    this.snackBar.open(message, 'Close', {\n      duration: 3000,\n      // milliseconds\n      verticalPosition: 'bottom',\n      // or 'top'\n      panelClass: [snackType]\n    });\n  }\n};\n__decorate([ViewChild('mediaInput')], PublishComponent.prototype, \"mediaInput\", void 0);\nPublishComponent = __decorate([Component({\n  selector: 'app-publish',\n  templateUrl: './publish.component.html',\n  styleUrls: ['./publish.component.css']\n})], PublishComponent);\nexport { PublishComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}